<!DOCTYPE html>
<html lang="zh-CN">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>DLS-Portfolio</title>
        <style>
        @import url(style.css);
        </style>
    <!-- å¼•å…¥axiosåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    </head>

    <body>
        <div class="header">
            <div class="logo">
                <img src="images/è“å­—æ¨ªç‰ˆç»„åˆ.png" alt="DLS-Logo">  
            </div>
            <div class="nav">
            <ul>
                <li>
                    <a href="index.html" target="_blank rel="noopemer>é¦–é¡µ</a>
                </li>
                <li>
                            <a href="about.html" target="_blank" rel="noopener">å…³äºæˆ‘</a>
                </li>
                <li>
                            <a href="portfolio.html" target="_blank" rel="noopener">æˆ‘çš„é¡¹ç›®</a>
                </li>
                <li>
                            <a href="contact.html" target="_blank" rel="noopener">è”ç³»æˆ‘</a>
                </li>
                <li>
                    <button id="themeToggle" class="theme-toggle" aria-label="åˆ‡æ¢ä¸»é¢˜">â˜€ï¸</button>
                </li>
            </ul>
        </div>
    </div>

    <!-- é¡¹ç›®å±•ç¤ºåŒºåŸŸ -->
    <div class="projects-section">
        <div class="section-header">
            <h2 id="project">æˆ‘çš„GitHubé¡¹ç›®</h2>
        </div>
        <!-- è¯­è¨€ç­›é€‰æŒ‰é’®åŒºåŸŸ -->
        <div id="language-filters" class="language-filters" style="display: none;">
            <h3>æŒ‰ç¼–ç¨‹è¯­è¨€ç­›é€‰</h3>
            <div class="filter-buttons">
                <button class="filter-btn active" data-language="all">
                    ğŸŒ å…¨éƒ¨
                </button>
                <!-- è¯­è¨€ç­›é€‰æŒ‰é’®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <div id="projects-grid" class="projects-grid">
            <!-- é¡¹ç›®å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            <div class="loading-spinner">
                <div class="spinner"></div>
                <p>æ­£åœ¨ä»GitHubåŠ è½½é¡¹ç›®æ•°æ®...</p>
            </div>
        </div>
    </div>
    <div class="pictures">
        <h2>é¡¹ç›®å›¾ç‰‡ä»‹ç»</h2>
        <header class="pictures-header">
            <img src="images/1.png" alt="é¡¹ç›®1çš„å›¾ç‰‡">
            <img src="images/2.png" alt="é¡¹ç›®2çš„å›¾ç‰‡">
            <img src="images/3.png" alt="é¡¹ç›®3çš„å›¾ç‰‡">
            <img src="images/4.png" alt="é¡¹ç›®4çš„å›¾ç‰‡">
            <img src="images/5.png" alt="é¡¹ç›®5çš„å›¾ç‰‡">
            <img src="images/6.png" alt="é¡¹ç›®6çš„å›¾ç‰‡">
        </header>
    </div>
</body>
<script>
    // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
    const themeToggle = document.getElementById('themeToggle');

    // æ£€æŸ¥æœ¬åœ°å­˜å‚¨ä¸­çš„ä¸»é¢˜è®¾ç½®
    const currentTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', currentTheme);

    // æ ¹æ®å½“å‰ä¸»é¢˜è®¾ç½®æŒ‰é’®å›¾æ ‡
    function updateThemeIcon() {
        const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
        themeToggle.textContent = isDark ? 'ğŸŒ™' : 'â˜€ï¸';
    }

    // åˆå§‹åŒ–æŒ‰é’®å›¾æ ‡
    updateThemeIcon();

    // ä¸»é¢˜åˆ‡æ¢äº‹ä»¶
    themeToggle.addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

        // åº”ç”¨æ–°ä¸»é¢˜
        document.documentElement.setAttribute('data-theme', newTheme);

        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        localStorage.setItem('theme', newTheme);

        // æ›´æ–°æŒ‰é’®å›¾æ ‡
        updateThemeIcon();

        // æ·»åŠ ç‚¹å‡»åé¦ˆ
        themeToggle.style.transform = 'scale(0.9)';
        setTimeout(() => {
            themeToggle.style.transform = 'scale(1)';
        }, 150);
    });

    // ========================================
    // GitHubé¡¹ç›®åŠ¨æ€åŠ è½½ç³»ç»Ÿ
    // ========================================

    // GitHub APIé…ç½®
    const GITHUB_CONFIG = {
        username: 'Dailers1', // æ›¿æ¢ä¸ºä½ çš„GitHubç”¨æˆ·å
        apiUrl: 'https://api.github.com/users/Dailers1/repos',
        perPage: 10, // æ¯é¡µæ˜¾ç¤ºçš„é¡¹ç›®æ•°é‡
        sortBy: 'updated' // æŒ‰æ›´æ–°æ—¶é—´æ’åº
    };

    // é¡¹ç›®å¡ç‰‡ç±»
    class ProjectCard {
        constructor(repoData) {
            this.repoData = repoData;
        }

        // æ¸²æŸ“é¡¹ç›®å¡ç‰‡
        render() {
            const card = document.createElement('article');
            card.className = 'project-card';
            
            // è·å–ä¸»è¦ç¼–ç¨‹è¯­è¨€
            const language = this.repoData.language || 'å…¶ä»–';
            const languageColor = this.getLanguageColor(language);
            
            // æ ¼å¼åŒ–æ—¥æœŸ
            const createdDate = new Date(this.repoData.created_at).toLocaleDateString('zh-CN');
            const updatedDate = new Date(this.repoData.updated_at).toLocaleDateString('zh-CN');
            
            // è·å–ä»“åº“å¤§å°ï¼ˆMBï¼‰
            const sizeInMB = (this.repoData.size / 1024).toFixed(1);
            
            card.innerHTML = `
            <header>
                    <h2>
                        <a href="${this.repoData.html_url}" target="_blank" rel="noopener" class="repo-name">
                            ${this.repoData.name}
                        </a>
                    </h2>
                    <div class="project-meta">
                        <span class="project-tag language-tag" style="background-color: ${languageColor}">
                            ${language}
                        </span>
                        <span class="project-tag star-tag">
                            ${this.repoData.stargazers_count} â­
                        </span>
                        <span class="project-tag fork-tag">
                            ${this.repoData.forks_count} ğŸ´
                        </span>
                        <span class="project-tag size-tag">
                            ${sizeInMB} MB
                        </span>
                    </div>
            </header>
                <section class="description-section">
                <h3>é¡¹ç›®æè¿°</h3>
                    <p>${this.repoData.description || 'æš‚æ— æè¿°'}</p>
            </section>
                <section class="info-section">
                    <h3>é¡¹ç›®ä¿¡æ¯</h3>
                    <ul>
                        <li><strong>æœ€åæ›´æ–°ï¼š</strong>${updatedDate}</li>
                        <li><strong>å¼€æºåè®®ï¼š</strong>${this.repoData.license?.name || 'æœªæŒ‡å®š'}</li>
                        <li><strong>å¯è§æ€§ï¼š</strong>${this.repoData.private ? 'ç§æœ‰' : 'å…¬å¼€'}</li>
                    </ul>
            </section>
                <section class="links-section">
                <h3>é¡¹ç›®é“¾æ¥</h3>
                    <div class="project-links">
                        <a href="${this.repoData.html_url}" target="_blank" rel="noopener" class="project-link">
                            <span>ğŸ“ æŸ¥çœ‹GitHubä»“åº“</span>
                        </a>
                        ${this.repoData.homepage ? `
                            <a href="${this.repoData.homepage}" target="_blank" rel="noopener" class="project-link homepage-link">
                                <span>ğŸŒ è®¿é—®é¡¹ç›®ç½‘ç«™</span>
                            </a>
                        ` : ''}
                    </div>
            </section>
            `;
            
            return card;
        }

        // è·å–ç¼–ç¨‹è¯­è¨€å¯¹åº”çš„é¢œè‰²
        getLanguageColor(language) {
            const languageColors = {
                'JavaScript': '#f1e05a',
                'Python': '#3572A5',
                'Java': '#b07219',
                'C++': '#f34b7d',
                'C': '#555555',
                'HTML': '#e34c26',
                'CSS': '#563d7c',
                'TypeScript': '#2b7489',
                'PHP': '#4F5D95',
                'Ruby': '#701516',
                'Go': '#00ADD8',
                'Rust': '#dea584',
                'Swift': '#ffac45',
                'Kotlin': '#F18E33',
                'Scala': '#c22d40',
                'å…¶ä»–': '#6c757d'
            };
            return languageColors[language] || languageColors['å…¶ä»–'];
        }
    }

    // GitHubé¡¹ç›®ç®¡ç†å™¨
    class GitHubProjectManager {
        constructor() {
            this.projectsGrid = document.getElementById('projects-grid');
            this.refreshBtn = document.getElementById('refreshBtn');
            this.languageFilters = document.getElementById('language-filters');
            this.filterButtons = document.querySelector('.filter-buttons');
            this.isLoading = false;
            this.allRepos = []; // å­˜å‚¨æ‰€æœ‰ä»“åº“æ•°æ®
            this.currentFilter = 'all'; // å½“å‰ç­›é€‰çŠ¶æ€
            
            this.initRefreshButton();
            this.initFilterSystem();
        }

        // åˆå§‹åŒ–åˆ·æ–°æŒ‰é’®
        initRefreshButton() {
            if (!this.refreshBtn) return; // åˆ·æ–°æŒ‰é’®å·²ç§»é™¤æ—¶è·³è¿‡
            this.refreshBtn.addEventListener('click', () => {
                if (!this.isLoading) {
                    this.refreshProjects();
                }
            });
        }

        // åˆå§‹åŒ–ç­›é€‰ç³»ç»Ÿ
        initFilterSystem() {
            // ä½¿ç”¨äº‹ä»¶å§”æ‰˜å¤„ç†ç­›é€‰æŒ‰é’®ç‚¹å‡»
            this.filterButtons.addEventListener('click', (e) => {
                if (e.target.classList.contains('filter-btn')) {
                    const language = e.target.dataset.language;
                    this.filterProjects(language);
                }
            });
        }

        // åˆ·æ–°é¡¹ç›®æ•°æ®
        async refreshProjects() {
            this.refreshBtn.disabled = true;
            this.refreshBtn.textContent = 'ğŸ”„ åˆ·æ–°ä¸­...';
            
            try {
                await this.loadProjects();
                this.showSuccessMessage('é¡¹ç›®æ•°æ®å·²æ›´æ–°ï¼');
            } catch (error) {
                console.error('åˆ·æ–°å¤±è´¥:', error);
            } finally {
                this.refreshBtn.disabled = false;
                this.refreshBtn.textContent = 'ğŸ”„ åˆ·æ–°';
            }
        }

        // ç­›é€‰é¡¹ç›®
        filterProjects(language) {
            if (this.currentFilter === language) return;
            
            this.currentFilter = language;
            this.updateFilterButtons(language);
            
            const projectCards = this.projectsGrid.querySelectorAll('.project-card');
            
            projectCards.forEach(card => {
                const cardLanguage = card.dataset.language || 'å…¶ä»–';
                
                if (language === 'all' || cardLanguage === language) {
                    // æ˜¾ç¤ºé¡¹ç›®å¡ç‰‡
                    card.classList.remove('filtered-out');
                    card.classList.add('filtered-in');
                } else {
                    // éšè—é¡¹ç›®å¡ç‰‡
                    card.classList.add('filtered-out');
                    card.classList.remove('filtered-in');
                }
            });
            
            // æ›´æ–°é¡¹ç›®è®¡æ•°
            this.updateProjectCount(language);
        }

        // æ›´æ–°ç­›é€‰æŒ‰é’®çŠ¶æ€
        updateFilterButtons(activeLanguage) {
            const buttons = this.filterButtons.querySelectorAll('.filter-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.language === activeLanguage) {
                    btn.classList.add('active');
                }
            });
        }

        // æ›´æ–°é¡¹ç›®è®¡æ•°
        updateProjectCount(language) {
            const visibleCards = this.projectsGrid.querySelectorAll('.project-card:not(.filtered-out)');
            const totalCards = this.projectsGrid.querySelectorAll('.project-card').length;
            
            let countText = '';
            if (language === 'all') {
                countText = `æ˜¾ç¤ºå…¨éƒ¨ ${totalCards} ä¸ªé¡¹ç›®`;
            } else {
                countText = `æ˜¾ç¤º ${language} é¡¹ç›® (${visibleCards.length}/${totalCards})`;
            }
            
            // æ›´æ–°ç­›é€‰åŒºåŸŸæ ‡é¢˜
            const filterTitle = this.languageFilters.querySelector('h3');
            filterTitle.textContent = `æŒ‰ç¼–ç¨‹è¯­è¨€ç­›é€‰ - ${countText}`;
        }

        // åˆå§‹åŒ–
        async init() {
            try {
                await this.loadProjects();
            } catch (error) {
                this.showError('åŠ è½½é¡¹ç›®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
                console.error('åŠ è½½é¡¹ç›®å¤±è´¥:', error);
            }
        }

        // åŠ è½½é¡¹ç›®æ•°æ®
        async loadProjects() {
            this.isLoading = true;
            this.showLoading();

            try {
                const repos = await this.fetchGitHubRepos();
                this.renderProjects(repos);
            } catch (error) {
                throw error;
            } finally {
                this.isLoading = false;
            }
        }

        // ä»GitHub APIè·å–ä»“åº“æ•°æ® (ä½¿ç”¨axios)
        async fetchGitHubRepos() {
            const url = `${GITHUB_CONFIG.apiUrl}`;
            const params = {
                sort: GITHUB_CONFIG.sortBy,
                per_page: GITHUB_CONFIG.perPage,
                type: 'owner' // åªè·å–ç”¨æˆ·è‡ªå·±çš„ä»“åº“
            };
            
            console.log('ğŸ”— æ­£åœ¨è¿æ¥GitHub API:', url);
            console.log('ğŸ“‹ è¯·æ±‚å‚æ•°:', params);
            
            try {
                // ä½¿ç”¨axioså‘é€è¯·æ±‚
                const response = await axios.get(url, { 
                    params,
                    headers: {
                        'Accept': 'application/vnd.github.v3+json',
                        'User-Agent': 'DLS-Portfolio-App'
                    },
                    timeout: 10000 // 10ç§’è¶…æ—¶
                });
                
                console.log('ğŸ“¡ APIå“åº”çŠ¶æ€:', response.status, response.statusText);
                console.log('ğŸ“¦ è·å–åˆ°ä»“åº“æ•°é‡:', response.data.length);
                console.log('ğŸ“‹ ä»“åº“åˆ—è¡¨:', response.data.map(repo => repo.name));
                
                // è¿‡æ»¤æ‰forkçš„ä»“åº“ï¼Œåªæ˜¾ç¤ºåŸåˆ›é¡¹ç›®
                const originalRepos = response.data.filter(repo => !repo.fork);
                console.log('ğŸ¯ åŸåˆ›ä»“åº“æ•°é‡:', originalRepos.length);
                
                return originalRepos;
            } catch (error) {
                console.error('âŒ è·å–GitHubä»“åº“å¤±è´¥:', error);
                
                if (error.response) {
                    // æœåŠ¡å™¨å“åº”äº†é”™è¯¯çŠ¶æ€ç 
                    const status = error.response.status;
                    if (status === 404) {
                        throw new Error(`GitHubç”¨æˆ· '${GITHUB_CONFIG.username}' ä¸å­˜åœ¨`);
                    } else if (status === 403) {
                        throw new Error('APIè¯·æ±‚è¢«é™åˆ¶ï¼Œè¯·ç¨åé‡è¯•');
                    } else {
                        throw new Error(`GitHub APIé”™è¯¯ (${status}): ${error.response.data?.message || 'æœªçŸ¥é”™è¯¯'}`);
                    }
                } else if (error.request) {
                    // è¯·æ±‚å·²å‘å‡ºä½†æ²¡æœ‰æ”¶åˆ°å“åº”
                    throw new Error('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®');
                } else {
                    // å…¶ä»–é”™è¯¯
                    throw new Error(`è¯·æ±‚é…ç½®é”™è¯¯: ${error.message}`);
                }
            }
        }

        // æ¸²æŸ“é¡¹ç›®åˆ—è¡¨
        renderProjects(repos) {
            if (!repos || repos.length === 0) {
                this.showMessage('æš‚æ— å…¬å¼€é¡¹ç›®');
                return;
            }

            // å­˜å‚¨æ‰€æœ‰ä»“åº“æ•°æ®
            this.allRepos = repos;

            // æ¸…ç©ºåŠ è½½åŠ¨ç”»
            this.projectsGrid.innerHTML = '';

            // æ¸²æŸ“æ¯ä¸ªé¡¹ç›®å¡ç‰‡
            repos.forEach(repo => {
                const projectCard = new ProjectCard(repo);
                const cardElement = projectCard.render();
                
                // ä¸ºé¡¹ç›®å¡ç‰‡æ·»åŠ è¯­è¨€æ•°æ®å±æ€§ï¼Œç”¨äºç­›é€‰
                const language = repo.language || 'å…¶ä»–';
                cardElement.dataset.language = language;
                
                this.projectsGrid.appendChild(cardElement);
            });

            // ç”Ÿæˆè¯­è¨€ç­›é€‰æŒ‰é’®
            this.generateLanguageFilters(repos);
        }

        // ç”Ÿæˆè¯­è¨€ç­›é€‰æŒ‰é’®
        generateLanguageFilters(repos) {
            // ä½¿ç”¨æ•°ç»„é«˜é˜¶å‡½æ•°æå–å”¯ä¸€çš„ç¼–ç¨‹è¯­è¨€
            const languages = repos
                .map(repo => repo.language || 'å…¶ä»–')
                .filter((language, index, arr) => arr.indexOf(language) === index)
                .sort(); // æŒ‰å­—æ¯é¡ºåºæ’åº

            console.log('ğŸ” æ£€æµ‹åˆ°çš„ç¼–ç¨‹è¯­è¨€:', languages);

            // æ¸…ç©ºç°æœ‰æŒ‰é’®ï¼ˆä¿ç•™"å…¨éƒ¨"æŒ‰é’®ï¼‰
            const allButton = this.filterButtons.querySelector('[data-language="all"]');
            this.filterButtons.innerHTML = '';
            this.filterButtons.appendChild(allButton);

            // ä¸ºæ¯ç§è¯­è¨€åˆ›å»ºç­›é€‰æŒ‰é’®
            languages.forEach(language => {
                const button = document.createElement('button');
                button.className = 'filter-btn';
                button.dataset.language = language;
                button.textContent = `${this.getLanguageIcon(language)} ${language}`;
                
                this.filterButtons.appendChild(button);
            });

            // æ˜¾ç¤ºç­›é€‰åŒºåŸŸ
            this.languageFilters.style.display = 'block';
            
            // æ›´æ–°é¡¹ç›®è®¡æ•°
            this.updateProjectCount('all');
        }

        // è·å–ç¼–ç¨‹è¯­è¨€å¯¹åº”çš„å›¾æ ‡
        getLanguageIcon(language) {
            const languageIcons = {
                'JavaScript': 'ğŸŸ¡',
                'Python': 'ğŸ',
                'Java': 'â˜•',
                'C++': 'ğŸ”´',
                'C': 'ğŸ”µ',
                'HTML': 'ğŸŒ',
                'CSS': 'ğŸ¨',
                'TypeScript': 'ğŸ”·',
                'PHP': 'ğŸ˜',
                'Ruby': 'ğŸ’',
                'Go': 'ğŸ¹',
                'Rust': 'ğŸ¦€',
                'Swift': 'ğŸ',
                'Kotlin': 'ğŸŸ ',
                'Scala': 'ğŸ”º',
                'å…¶ä»–': 'ğŸ“'
            };
            return languageIcons[language] || 'ğŸ“';
        }

        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        showLoading() {
            this.projectsGrid.innerHTML = `
                <div class="loading-spinner">
                    <div class="spinner"></div>
                    <p>æ­£åœ¨ä»GitHubåŠ è½½é¡¹ç›®æ•°æ®...</p>
                </div>
            `;
        }

        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        showError(message) {
            this.projectsGrid.innerHTML = `
                <div class="error-message">
                    <p>âŒ ${message}</p>
                    <button onclick="location.reload()" class="retry-btn">é‡è¯•</button>
                </div>
            `;
        }

        // æ˜¾ç¤ºæç¤ºä¿¡æ¯
        showMessage(message) {
            this.projectsGrid.innerHTML = `
                <div class="message">
                    <p>â„¹ï¸ ${message}</p>
                </div>
            `;
        }

        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.innerHTML = `<p>âœ… ${message}</p>`;
            
            // åœ¨é¡¹ç›®ç½‘æ ¼ä¸Šæ–¹æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            this.projectsGrid.parentNode.insertBefore(successDiv, this.projectsGrid);
            
            // 3ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
        const projectManager = new GitHubProjectManager();
        projectManager.init();
    });
</script>

</html>
